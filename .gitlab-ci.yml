include:
  - project: "epm-gpt/common/common-ci-templates"
    ref: "main"
    file:
    - "pipelines/cicd/docker_helm.yml"

variables:
  HELM_NS_NAME: "epm-gpt-common"
  HELM_CHART: "./helm/chat"
  HELM_RELEASE_NAME: "${CI_PROJECT_NAME}-${CI_COMMIT_REF_SLUG}"
  HELM_EXTRA_ARGS: "--values ./helm/dev.yaml --set image.tag=${CI_COMMIT_REF_SLUG}"

prepare_version:
  except:
    variables:
      - $CI_COMMIT_MESSAGE =~ /no-build/

build_and_release:
  except:
    variables:
      - $CI_COMMIT_MESSAGE =~ /no-build/

release:
  except:
    variables:
      - $CI_COMMIT_MESSAGE =~ /no-build/
